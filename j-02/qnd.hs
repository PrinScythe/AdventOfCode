

newPosFrom :: (Num a, Read a) => String -> [a]
newPosFrom direction = case words direction of
    ["forward", t] -> [0, read t]
    ["down", t] -> [read t, 0]
    ["up", t] -> [- read t, 0]
    _ -> [0,0]


newPosAimFrom :: (Num a, Read a) => [a] -> String -> [a]
newPosAimFrom prevPosAim direction = case words direction of
    ["forward", t] -> [head prevPosAim + last prevPosAim * read t, head (tail prevPosAim) + read t, last prevPosAim]
    ["down", t] -> [head prevPosAim, head (tail prevPosAim), last prevPosAim + read t]
    ["up", t] -> [head prevPosAim, head (tail prevPosAim), last prevPosAim - read t]
    _ -> prevPosAim

part1 :: (Num a, Read a) => [String] -> a
part1 directions = product (foldl (\d1 d2 -> [head d1 + head d2, last d1 + last d2]) [0,0] (map newPosFrom directions))

part2 :: (Foldable t, Num a, Read a) => t String -> a
part2 directions = head l * head (tail l) where l = foldl newPosAimFrom [0, 0, 0] directions

solve1 :: Integer
solve1 = part1 input1

solve2 :: Integer
solve2 = part2 input1


solve1' :: Integer
solve1' = part1 input2

solve2' :: Integer
solve2' = part2 input2

example :: [[Char]]
example = ["forward 5","down 5","forward 8","up 3","down 8","forward 2"]

input1 :: [[Char]]
input1 = ["forward 1","down 9","down 4","forward 4","down 2","down 7","up 9","down 5","forward 9","forward 9","down 2","forward 7","forward 9","down 5","down 2","up 9","down 7","forward 6","down 6","down 6","up 1","down 2","forward 8","forward 8","forward 9","up 1","forward 4","up 1","forward 3","forward 5","up 3","up 7","down 4","down 1","forward 3","forward 4","up 3","forward 9","down 2","forward 5","up 2","up 1","up 5","forward 1","up 9","forward 6","up 4","down 4","forward 3","up 7","down 1","down 1","down 8","forward 3","forward 1","up 7","up 1","down 4","up 6","down 6","forward 8","down 3","down 9","down 6","up 8","forward 8","down 9","up 7","down 7","forward 8","down 8","up 6","down 7","down 4","up 7","forward 7","forward 7","forward 2","forward 5","down 5","down 9","down 8","down 5","up 3","down 3","down 6","down 6","forward 1","down 2","forward 2","down 5","up 2","forward 5","down 1","down 3","forward 4","down 2","forward 8","down 6","forward 3","forward 3","forward 9","down 9","down 4","down 8","down 7","down 3","up 6","down 7","forward 9","up 9","down 8","forward 9","forward 8","down 2","up 4","forward 8","up 7","down 2","forward 6","forward 7","down 5","up 4","down 3","down 3","down 5","down 2","down 5","forward 8","forward 8","down 5","up 4","down 6","forward 5","up 6","up 5","down 4","forward 7","forward 5","down 7","up 9","up 4","up 9","forward 8","down 8","down 8","down 2","down 8","down 8","up 6","forward 2","down 9","forward 5","forward 4","down 8","up 5","forward 3","forward 1","down 6","forward 9","forward 2","forward 1","up 5","down 2","forward 5","up 6","up 6","forward 9","up 3","forward 2","forward 9","down 9","down 5","up 4","up 7","up 8","forward 4","forward 3","down 7","down 5","forward 5","down 6","forward 9","up 4","up 6","down 2","forward 6","forward 7","up 9","up 5","down 4","up 5","down 2","forward 4","up 9","down 1","forward 7","down 9","forward 5","down 5","down 2","up 4","up 8","down 8","down 7","up 7","down 1","forward 5","forward 8","down 2","down 1","forward 8","down 7","up 6","forward 9","forward 4","down 8","forward 1","up 8","forward 3","up 4","forward 9","down 6","forward 5","forward 1","forward 8","forward 5","forward 8","down 4","forward 8","forward 2","forward 8","forward 3","down 3","forward 6","up 6","up 9","down 4","down 6","forward 6","down 9","up 2","down 8","down 6","down 1","forward 1","down 2","down 3","forward 5","forward 6","down 5","up 7","up 2","forward 2","down 4","down 4","forward 3","down 4","up 4","forward 1","down 4","forward 9","forward 7","forward 6","down 3","down 4","forward 3","forward 3","forward 3","up 6","forward 4","forward 7","forward 3","forward 5","forward 7","forward 4","down 1","up 2","up 7","forward 4","down 2","forward 2","up 7","down 7","forward 5","forward 9","down 8","forward 5","forward 5","down 9","forward 1","forward 6","down 2","down 3","down 1","down 7","down 3","up 3","down 3","forward 5","down 4","forward 6","forward 2","down 4","forward 4","up 5","up 3","forward 2","forward 5","down 7","up 9","up 5","down 3","forward 8","forward 4","down 8","up 4","forward 8","forward 7","forward 1","down 2","down 6","up 7","forward 9","down 2","down 4","down 3","down 8","up 4","down 2","up 3","forward 1","down 2","up 6","down 9","up 3","down 1","down 1","forward 4","down 2","forward 3","forward 5","forward 7","down 7","up 3","up 5","down 1","down 2","forward 4","down 1","down 1","down 7","up 4","forward 3","down 3","forward 2","down 3","up 7","down 1","up 5","down 7","forward 4","up 2","forward 5","up 4","down 4","down 3","forward 1","up 9","down 5","forward 9","forward 1","down 7","down 2","down 4","down 2","forward 3","down 1","down 2","up 9","forward 2","down 8","forward 1","forward 3","down 5","down 4","forward 2","forward 8","forward 9","down 9","down 6","up 3","forward 1","down 6","down 7","up 3","forward 9","down 2","up 4","forward 3","forward 6","forward 6","down 7","forward 7","forward 6","down 7","up 9","forward 7","down 1","down 8","down 2","down 2","down 9","down 6","forward 1","down 9","forward 9","forward 8","forward 6","forward 9","down 5","forward 9","forward 4","forward 4","down 6","forward 6","forward 5","forward 7","down 7","down 9","forward 4","down 9","up 5","forward 6","down 6","forward 9","up 7","forward 6","up 6","up 9","forward 9","up 4","down 3","up 9","down 8","down 2","forward 4","down 8","down 2","forward 2","down 5","up 3","down 1","forward 4","down 3","forward 3","down 9","forward 6","forward 6","down 9","forward 6","forward 1","down 5","up 1","forward 3","forward 1","forward 5","down 8","forward 7","forward 2","up 3","forward 8","forward 1","forward 7","down 1","down 4","forward 7","forward 9","forward 4","down 2","forward 5","forward 3","forward 9","forward 3","up 3","forward 9","down 3","forward 9","forward 3","forward 7","down 5","forward 6","down 6","forward 5","forward 1","down 1","forward 8","down 3","up 1","down 6","forward 7","up 5","up 7","down 3","forward 8","up 8","down 4","up 6","up 7","forward 1","forward 2","forward 7","down 1","forward 4","down 8","up 6","up 7","up 4","down 7","down 8","down 6","forward 5","forward 9","down 7","forward 8","down 9","down 9","forward 5","forward 2","up 4","down 2","forward 3","down 2","forward 1","down 7","down 6","forward 5","up 2","forward 4","down 4","forward 5","forward 7","up 5","down 7","forward 9","forward 3","forward 6","up 8","down 9","forward 1","up 8","forward 3","down 6","down 1","down 3","down 4","up 2","up 3","forward 8","up 7","down 2","forward 1","down 6","forward 1","down 8","forward 3","forward 5","forward 5","up 5","forward 4","forward 6","down 8","up 7","forward 8","up 6","forward 5","down 4","forward 8","down 3","forward 7","forward 9","forward 8","up 9","forward 4","up 5","up 8","down 8","forward 1","down 1","forward 3","forward 9","down 9","up 2","forward 5","down 1","down 6","forward 2","forward 2","down 2","down 8","forward 5","up 2","up 2","forward 3","down 6","up 2","down 2","down 1","up 9","forward 6","up 4","forward 4","down 2","forward 8","up 9","down 1","forward 9","up 3","up 7","forward 5","down 9","down 2","down 5","up 4","up 8","up 2","down 1","up 4","forward 8","forward 2","down 8","forward 9","forward 1","down 5","forward 3","down 6","forward 3","up 2","down 9","down 6","down 4","down 9","down 8","forward 2","forward 7","up 4","forward 8","up 9","up 6","forward 2","down 1","down 5","down 5","down 3","up 9","up 9","forward 9","forward 5","down 1","down 3","down 8","down 4","forward 5","up 4","down 2","down 5","down 4","down 8","down 2","forward 9","forward 7","up 9","forward 8","down 9","down 2","forward 5","down 9","forward 7","down 2","down 9","forward 4","up 7","down 9","forward 6","forward 2","down 1","down 9","down 3","down 7","down 8","down 5","down 9","down 1","up 9","down 7","forward 7","up 4","down 2","down 4","forward 6","forward 8","forward 1","forward 2","up 2","up 2","forward 9","down 9","forward 8","forward 6","forward 5","down 2","forward 7","up 3","up 8","forward 1","forward 5","down 7","down 7","forward 5","down 1","up 3","up 8","forward 5","forward 7","forward 3","down 6","up 7","forward 8","down 5","up 3","forward 7","down 2","down 1","down 1","forward 1","down 1","down 8","down 3","up 1","forward 8","forward 9","forward 5","forward 8","down 2","forward 3","down 5","up 9","down 9","down 5","forward 1","up 9","up 4","up 7","up 9","up 4","down 2","forward 6","forward 4","up 5","up 6","down 8","down 6","down 6","up 3","forward 3","down 9","down 5","down 5","forward 7","down 6","forward 7","down 9","down 8","down 3","down 7","down 4","down 1","forward 6","up 7","down 1","forward 7","down 2","forward 4","down 3","forward 6","up 7","forward 3","down 3","up 6","down 2","down 4","down 8","forward 6","down 4","forward 7","down 2","forward 9","down 3","down 6","down 3","down 6","forward 4","down 8","up 5","down 6","forward 6","down 6","forward 9","up 8","down 7","up 1","forward 4","up 3","forward 9","up 6","forward 4","up 8","forward 2","down 7","down 7","forward 1","up 9","up 7","forward 3","down 1","up 5","forward 3","forward 1","forward 3","forward 7","down 6","down 1","forward 9","up 1","up 1","down 8","down 7","forward 1","up 8","up 6","down 8","forward 1","up 3","down 7","forward 7","down 7","forward 4","forward 6","up 2","down 9","forward 9","down 4","up 2","forward 7","forward 4","up 8","up 5","down 8","forward 7","forward 6","down 1","up 5","up 5","down 3","forward 7","forward 1","forward 7","forward 1","down 3","forward 3","forward 4","forward 6","down 3","up 4","up 5","down 8","up 3","forward 4","forward 6","forward 8","forward 4","forward 7","down 9","up 3","down 1","up 4","forward 8","forward 5","forward 4","forward 1","down 2","down 7","down 6","forward 4","forward 2","up 2","down 2","forward 2","forward 2","up 6","forward 6","forward 1","forward 8","up 7","forward 4","forward 2","down 2","down 1","forward 4","down 4","up 7","up 2","up 3","down 5","forward 2","forward 9","down 2","down 9","down 4","down 8","up 9","up 5","up 2","forward 6","down 6","forward 9","forward 7","forward 8","forward 4","up 9","forward 9","down 8","down 2","forward 5","down 8","down 8","forward 8","forward 6","forward 7","down 8","forward 1","forward 6","down 4","forward 1","down 3","forward 1","down 8","forward 2","down 4","down 6","down 4","up 9","forward 6","up 3","down 7","forward 3","down 8","forward 6","forward 3","down 1","forward 1","up 6","down 1","down 2","forward 5","down 3","up 5","forward 6","forward 7","forward 2","forward 9","down 7","up 4","forward 6","forward 8","down 6","down 7","down 4","down 5","down 6","down 3","up 1","forward 2","forward 3","down 1","down 7","up 8","forward 1","forward 6","up 3","down 1","up 6","down 2","up 1","up 7","forward 3","up 8","forward 7","forward 5","forward 5"]

input2 :: [[Char]]
input2 = ["forward 2","down 4","down 1","down 4","forward 3","down 6","down 5","forward 3","forward 8","down 2","down 3","up 8","down 5","up 7","down 7","forward 5","up 2","down 6","forward 7","forward 1","forward 2","forward 7","up 7","forward 6","down 3","down 1","up 9","down 2","up 1","down 1","up 6","forward 6","down 7","forward 6","up 1","down 6","forward 2","up 7","forward 4","forward 8","forward 7","down 7","forward 8","down 1","down 6","down 7","forward 4","down 3","up 7","down 5","down 9","up 8","up 4","down 2","down 3","up 7","forward 6","forward 6","forward 8","forward 2","up 5","down 8","down 3","down 3","down 4","down 9","down 6","up 6","forward 4","down 6","forward 3","forward 3","down 4","down 8","down 2","up 5","up 5","forward 3","forward 5","down 7","forward 6","forward 9","forward 8","forward 2","down 3","down 3","down 7","down 1","down 1","down 1","down 2","down 8","down 6","forward 6","up 1","up 6","down 7","down 1","forward 1","up 2","up 8","up 8","forward 2","down 1","down 8","down 7","down 1","forward 1","down 9","up 3","down 3","forward 2","down 3","up 6","down 2","forward 7","down 9","down 6","down 1","forward 6","down 4","down 1","down 3","forward 3","down 5","forward 9","down 5","down 7","up 8","forward 8","forward 8","down 6","down 1","forward 8","down 4","up 4","up 4","up 2","forward 2","forward 2","down 1","up 8","down 1","down 7","forward 5","down 9","down 2","up 3","down 1","down 5","forward 6","down 7","up 3","forward 7","down 4","down 3","forward 4","up 8","down 4","forward 4","forward 2","forward 5","down 5","up 2","forward 4","down 4","forward 6","down 4","forward 1","down 5","forward 2","forward 2","down 8","forward 4","forward 7","down 3","up 3","forward 2","forward 6","forward 8","down 2","forward 4","down 2","up 9","down 9","down 2","forward 5","up 4","forward 2","down 2","down 3","forward 1","down 2","forward 8","forward 8","down 4","forward 6","down 3","down 3","down 5","forward 8","forward 4","forward 1","up 4","up 2","forward 8","down 8","forward 2","forward 6","up 1","up 5","forward 2","forward 4","forward 7","forward 8","forward 2","down 3","down 1","down 9","down 6","up 5","up 6","forward 6","down 3","down 2","down 1","forward 5","forward 2","forward 7","down 8","down 7","forward 7","up 8","forward 7","down 1","up 4","forward 9","forward 4","forward 1","down 3","down 9","down 7","forward 1","down 3","forward 3","down 4","down 7","forward 4","up 6","down 8","up 1","forward 6","forward 1","down 7","down 8","up 9","up 4","down 3","down 7","forward 8","up 2","up 6","forward 8","down 1","up 4","up 4","forward 8","down 2","down 4","down 3","forward 5","down 8","forward 1","down 2","forward 9","forward 3","up 6","down 6","forward 6","forward 4","down 6","down 3","down 3","forward 6","down 5","up 4","down 9","down 3","down 6","up 9","forward 6","down 2","forward 7","up 8","down 3","down 7","down 9","forward 6","down 1","forward 2","down 1","down 3","down 3","forward 5","forward 2","up 5","forward 4","up 7","down 9","forward 7","forward 3","down 6","forward 1","down 1","up 8","down 9","up 3","down 7","up 9","forward 7","down 7","down 9","forward 9","forward 7","up 9","down 7","down 2","down 7","up 2","down 3","down 9","down 6","forward 7","forward 8","forward 8","forward 6","forward 9","forward 4","down 4","down 5","down 7","forward 6","forward 2","forward 4","forward 9","down 4","forward 6","down 7","up 1","down 7","forward 9","forward 7","down 4","down 3","up 6","forward 8","forward 7","down 8","forward 4","up 6","up 4","forward 9","forward 4","forward 4","forward 7","down 1","up 6","forward 8","forward 3","up 6","forward 4","down 1","up 2","forward 1","down 5","forward 5","up 4","down 6","down 3","up 8","forward 9","down 2","forward 4","forward 8","down 9","forward 5","forward 2","down 9","down 8","forward 8","down 7","up 6","forward 1","up 9","up 3","forward 9","down 6","forward 9","down 3","down 3","forward 7","forward 5","down 8","down 9","down 3","down 6","up 8","down 9","forward 8","down 7","down 5","down 1","up 4","down 9","forward 6","forward 9","up 6","up 4","forward 3","forward 2","forward 1","down 1","down 2","forward 8","up 6","forward 5","up 4","down 1","forward 5","down 3","down 6","up 7","forward 2","forward 6","forward 7","forward 4","down 5","down 4","forward 4","down 6","up 2","up 2","forward 7","forward 3","down 8","down 1","down 8","forward 7","forward 7","up 5","forward 4","up 8","down 9","down 4","down 4","forward 5","down 1","forward 2","down 6","up 4","down 8","down 1","down 9","down 5","up 5","forward 4","down 2","down 8","down 4","forward 4","forward 5","down 8","up 9","forward 7","forward 6","down 8","down 3","up 7","down 7","forward 2","forward 5","forward 7","down 9","up 1","down 6","down 2","forward 6","forward 3","forward 3","up 9","forward 4","down 5","down 7","forward 8","forward 6","forward 5","down 9","down 5","down 1","down 7","forward 9","forward 8","down 2","down 4","down 1","up 5","up 5","forward 5","down 3","down 1","forward 8","up 9","up 3","down 3","up 3","up 5","forward 8","down 3","up 3","down 9","up 6","up 8","forward 5","up 2","down 6","forward 3","down 2","down 4","forward 9","forward 6","forward 3","up 5","down 9","down 7","forward 9","forward 7","forward 5","up 5","up 1","down 6","forward 4","forward 4","down 7","down 1","up 3","forward 6","forward 4","down 1","forward 5","forward 3","forward 1","forward 3","up 3","up 9","down 7","down 4","forward 8","down 8","down 3","up 2","down 8","forward 5","down 7","forward 6","down 9","up 5","forward 4","down 2","forward 6","down 8","down 7","forward 8","forward 5","down 2","forward 7","forward 5","forward 7","down 8","forward 5","down 8","down 6","down 7","down 9","forward 9","down 6","forward 8","up 6","up 1","down 5","forward 1","forward 7","up 2","up 5","up 6","down 5","down 5","forward 7","down 9","down 2","forward 9","forward 3","down 5","up 2","up 8","forward 5","forward 8","up 1","forward 3","forward 1","up 4","forward 1","down 9","down 6","forward 1","down 4","down 4","forward 9","down 3","up 6","down 3","forward 6","forward 6","down 3","forward 6","down 3","down 1","forward 3","down 7","up 9","forward 1","down 7","down 2","up 8","down 1","down 9","down 1","down 4","down 6","down 3","down 7","down 2","down 9","down 2","forward 4","up 3","down 4","up 4","down 1","forward 5","forward 7","down 7","forward 9","forward 6","down 8","forward 6","forward 7","up 3","down 3","up 6","forward 7","up 4","forward 4","down 1","up 8","forward 7","down 2","up 6","forward 1","forward 3","up 9","up 8","up 5","forward 7","up 5","down 6","forward 7","forward 7","down 4","down 3","forward 2","down 8","up 9","up 6","forward 7","forward 5","down 9","down 2","up 5","down 3","down 3","up 5","down 8","forward 7","down 4","down 2","up 9","down 5","down 8","down 5","down 6","forward 9","down 3","down 8","forward 3","down 1","down 9","forward 1","down 3","up 9","up 3","forward 8","up 2","down 4","up 5","up 4","down 9","down 5","up 3","forward 2","down 8","forward 8","forward 7","up 4","down 9","down 6","up 1","forward 9","up 8","forward 4","up 3","down 4","up 2","up 7","down 2","forward 3","down 8","down 9","up 7","up 8","forward 3","forward 1","forward 7","forward 5","forward 9","forward 2","up 1","down 1","up 4","forward 1","up 9","forward 7","forward 2","down 6","down 5","forward 9","forward 4","down 6","down 6","up 8","down 3","up 8","down 3","forward 2","down 1","down 1","forward 5","down 1","forward 9","up 8","forward 2","down 5","up 8","up 8","forward 8","forward 8","forward 3","forward 2","forward 8","forward 9","forward 8","forward 6","forward 4","up 7","forward 9","forward 8","up 7","forward 6","forward 9","forward 8","down 7","forward 9","down 4","down 1","up 1","up 9","forward 2","down 6","down 2","down 8","down 6","up 8","forward 7","up 9","forward 5","forward 4","forward 8","up 4","forward 4","up 6","forward 7","forward 1","up 8","down 6","forward 7","forward 3","forward 2","down 4","forward 4","down 7","down 6","down 2","up 3","up 5","down 7","down 9","up 8","down 1","up 1","down 8","up 8","forward 8","down 6","down 1","down 6","forward 3","down 9","down 5","up 3","down 1","down 1","forward 4","down 4","up 3","forward 8","up 4","down 3","down 5","down 3","forward 6","forward 3","down 2","forward 9","forward 3","forward 2","down 2","forward 6","down 1","down 1","forward 5","forward 4","forward 6","down 7","forward 7","forward 3","forward 1","up 3","down 6","forward 1","up 9","forward 9","forward 5","forward 3","forward 3","down 3","up 8","forward 5","up 6","forward 2","down 7","forward 2","forward 8","forward 8","forward 3","up 9","down 5","down 3","forward 7","up 9","forward 4","down 1","down 3","down 5","down 2","forward 9","up 6","down 3","down 7","down 3","up 6","forward 3","down 4","forward 2","down 8","down 2","forward 7","down 2","down 9","forward 1","down 1","down 9","down 6","forward 5","down 1","up 1","forward 5","forward 4","forward 9","down 3","forward 3","forward 5","down 9","forward 9","down 8","down 2","forward 1","up 1","down 5","forward 2","up 9","forward 9","forward 7","forward 9","forward 3","down 7","forward 2","down 4","up 3","down 7","down 6","forward 2","down 2","forward 8","up 9","down 1","forward 7","down 8","forward 3","down 2","down 5","down 5","down 3","forward 1","up 9","up 9","down 8","down 6","up 7","forward 7","down 4","forward 6","down 9","up 5","up 6","forward 4","forward 1","forward 1","down 7","down 8","down 2","down 4","down 3","up 8","down 3","forward 3","forward 8","up 3","down 2","forward 4","down 3","forward 5","up 1","down 9","down 1","down 4","forward 3","forward 6","forward 7","forward 2","forward 9","forward 1","forward 6","forward 7","forward 2","up 1","down 6","down 1","forward 6","down 6","down 5","forward 1"]